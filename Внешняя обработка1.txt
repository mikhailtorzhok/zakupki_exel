
&НаКлиенте
Процедура Рассчитать(Команда)
	// Вставить содержимое обработчика.
	Сообщить ("Привет, мир");
	ЗапроситьСписокКонтрагентовНаСервере();
	
	
	
	
КонецПроцедуры

 &НаСервере
 Процедура ЗапроситьСписокКонтрагентовНаСервере()
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	Корреспонденты.Ссылка КАК Ссылка,
		|	Корреспонденты.ИНН КАК ИНН
		|ИЗ
		|	Справочник.Корреспонденты КАК Корреспонденты";
	РезультатЗапроса = Запрос.Выполнить();
	ТабКорреспондентов = РезультатЗапроса.Выгрузить();
	Сообщить("Создание таблицы корреспонденты завершено");
	
	
	//ТабДок = Новый ТабличныйДокумент;
	//Макет = Обработки.ТабличныйДокументСохранитьвPDF.ПолучитьМакет("Макет");
	//ОбластьМакета = Макет.ПолучитьОбласть("Шапка");
	//ТабДок.Вывести(ОбластьМакета);
	//
	//МестоположениеФайла  = "D:\ProverkaZapisi\Тест.pdf";
	//ТабДок.Записать(МестоположениеФайла , ТипФайлаТабличногоДокумента.PDF);
	
	//Запись в Excel
	//МестоположениеФайла  = "D:\ProverkaZapisi\Тест.XLSX";
	//ТабДок.Записать(МестоположениеФайла , ТипФайлаТабличногоДокумента.XLSX);

	//Запись в Word
	//МестоположениеФайла  = "D:\ProverkaZapisi\Тест.docx";
	//ТабДок.Записать(МестоположениеФайла , ТипФайлаТабличногоДокумента.DOCX);
	
	//Прочие форматы
	//ТипФайлаТабличногоДокумента поддерживает множество форматов
	//html5, mxl, txt, ods, можете поэксперементировать с различными форматами
	
	Попытка Эксель = Новый COMОбъект ("Excel.Application");
		Исключение Сообщить (ОписаниеОшибки());
			Возврат;
		КонецПопытки;

	Книга = Эксель.WorkBooks.Add();
	Лист = Книга.WorkSheets (1);

	Лист.Cells(1,1).Value = "СтраховойНомер";
	Лист.Cells(1,2).Value = "Фамилия";
	Лист.Cells(1,3).Value = "Имя";
	Лист.Cells(1,4).Value = "Отчество";

	i = 1;

	Для Каждого ИНН из ТабКорреспондентов Цикл
		
		Лист.Cells (i,1).Value = "test";
		Лист.Cells (i,2).Value = "test";
		Лист.Cells (i,3).Value = "test";
		Лист.Cells (i,4).Value = "test";
		Если i=2 тогда Возврат;
		КонецЕсли;

	КонецЦикла;

	//Попытка Книга.SaveAs ("D:\ProverkaZapisi\Результат.xls");
	//	Исключение
	//	Сообщить (ОписаниеОшибки()+"Файл не сохранён!");	
	//	КонецПопытки;
	Эксель.Application.Quit();

	
	
	
	

	Сообщить("Файл успешно сохранен");
	
			 
КонецПроцедуры

