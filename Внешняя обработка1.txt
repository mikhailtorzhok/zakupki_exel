
&НаКлиенте
Процедура Рассчитать(Команда)
	// Вставить содержимое обработчика.
	Сообщить ("Привет, мир");
	МассивКорреспондентов = Новый Массив;
	МассивКорреспондентов = ЗапроситьСписокКонтрагентовНаСервере();
	тзВСтроке = ЗапроситьСписокКонтрагентовНаСервере();
	Сообщить ("Возврат Контрагентов");
	//ПолучитьИзВременногоХранилища(ЭтаФорма.УникальныйИдентификтор);
	//тз = ЗначениеИзСтрокиВнутр(тзВСтроке);
	Сообщить ("Успешное восстановление таблицы из временного хранилища");

	
	
	
	
КонецПроцедуры

 &НаСервере
Функция ЗапроситьСписокКонтрагентовНаСервере()
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	Корреспонденты.Ссылка КАК Ссылка,
		|	Корреспонденты.ИНН КАК ИНН
		|ИЗ
		|	Справочник.Корреспонденты КАК Корреспонденты";
	РезультатЗапроса = Запрос.Выполнить();
	ТабКорреспондентов = РезультатЗапроса.Выгрузить();
	
	МассивКорреспондентов = Новый Массив;
	
	тзВСтроке = ЗначениеВСтрокуВнутр(ТабКорреспондентов); 
	
	
	//Для каждого Корреспондентов Из ТабКорреспондентов Цикл
	//	МассивКорреспондентов.Добавить(Корреспондентов);
	//КонецЦикла;
	
	//ПоместитьВоВременноеХранилище(ТабКорреспондентов, ЭтаФорма.УникальныйИдентификтор); 
	
	//ТЗ = ТабКорреспондентов;

	//ДобавляемыеРеквизиты = Новый Массив;
	//УдаляемыеРеквизиты = Новый Массив;

	//Получаем уже созданную на форме Таблицу значений 1С

	//ИмяТФ = «ТаблицаЗначенийФормы”;

	//ТаблицаФормы = РеквизитФормыВЗначение(«ТаблицаЗначенийФормы»);

	//Для Каждого ТекКолонка из ТаблицаФормы.Колонки Цикл
	//	УдаляемыеРеквизиты.Добавить(ТаблицаЗначенийФормы + «.» + ТекКолонка.Имя);
	//КонецЦикла;

	//Для Каждого ТекКолонка из ТЗ.Колонки Цикл
	//	ДобавляемыеРеквизиты.Добавить(Новый РеквизитФормы(ТекКолонка.Имя, ТекКолонка.ТипЗначения, ИмяТФ));
	//КонецЦикла;

	//Добавим новые, удалим старые колонки
	//ИзменитьРеквизиты(ДобавляемыеРеквизиты, УдаляемыеРеквизиты);
	// Поместим значение в реквизит формы 1С
	//ЗначениеВРеквизитФормы(ТЗ, ИмяТФ); 
	
	
	
	
	
	Сообщить("Создание таблицы корреспонденты завершено");
	Возврат(тзВСтроке);
КонецФункции
	
	//ТабДок = Новый ТабличныйДокумент;
	//Макет = Обработки.ТабличныйДокументСохранитьвPDF.ПолучитьМакет("Макет");
	//ОбластьМакета = Макет.ПолучитьОбласть("Шапка");
	//ТабДок.Вывести(ОбластьМакета);
	//
	//МестоположениеФайла  = "D:\ProverkaZapisi\Тест.pdf";
	//ТабДок.Записать(МестоположениеФайла , ТипФайлаТабличногоДокумента.PDF);
	
	//Запись в Excel
	//МестоположениеФайла  = "D:\ProverkaZapisi\Тест.XLSX";
	//ТабДок.Записать(МестоположениеФайла , ТипФайлаТабличногоДокумента.XLSX);

	//Запись в Word
	//МестоположениеФайла  = "D:\ProverkaZapisi\Тест.docx";
	//ТабДок.Записать(МестоположениеФайла , ТипФайлаТабличногоДокумента.DOCX);
	
	//Прочие форматы
	//ТипФайлаТабличногоДокумента поддерживает множество форматов
	//html5, mxl, txt, ods, можете поэксперементировать с различными форматами
	
	
	//ТабКорреспондентов.Записать("D:\ProverkaZapisi\Результат.xls", ТипФайлаТабличногоДокумента.XLS);

	//Excel = Новый COMОбъект("Excel.Application");
	//Excel.WorkBooks.Open("D:\ProverkaZapisi\Результат.xls"); 
	//Excel.Visible = 0;

	//Excel.ActiveWindow.DisplayWorkbookTabs = 1; 
	//Excel.ActiveWindow.TabRatio = 0.6;         

	//FullName = Excel.ActiveWorkbook.FullName;            
	//Excel.DisplayAlerts = false;
	//Excel.ActiveWorkbook.SaveAs(FullName, 18); // 18 - xls 97-2003; 51 - xlsx 2007-2013

	////Excel.Visible = 1;       // если нужно поработать дальше с книгой
	//Excel.Application.Quit(); // если просто выходим 

	
	
	
	
	//Попытка Эксель = Новый COMОбъект ("Excel.Application");
	//	Исключение Сообщить (ОписаниеОшибки());
	//		Возврат;
	//	КонецПопытки;

	//Книга = Эксель.WorkBooks.Add();
	//Лист = Книга.WorkSheets (1);

	//Лист.Cells(1,1).Value = "СтраховойНомер";
	//Лист.Cells(1,2).Value = "Фамилия";
	//Лист.Cells(1,3).Value = "Имя";
	//Лист.Cells(1,4).Value = "Отчество";

	//Счетчик = 1;

	//Для Каждого ИНН из ТабКорреспондентов Цикл
	//	
	//	Лист.Cells (Счетчик,1).Value = "test";
	//	Лист.Cells (Счетчик,2).Value = "test";
	//	Лист.Cells (Счетчик,3).Value = "test";
	//	Лист.Cells (Счетчик,4).Value = "test";
	//	Счетчик = Счетчик + 1;
	//	Если Счетчик = 2 Тогда
	//	Прервать;
	//	КонецЕсли;

	//	Сообщить(Счетчик);

	//КонецЦикла;

	
	//Эксель.WorkBooks.Open("D:\ProverkaZapisi\Результат.xls"); 
	//Эксель.Visible = 0;

	//Эксель.ActiveWindow.DisplayWorkbookTabs = 1; 
	//Эксель.ActiveWindow.TabRatio = 0.6;         

	//FullName = Эксель.ActiveWorkbook.FullName;            
	//Эксель.DisplayAlerts = false;
	//Эксель.ActiveWorkbook.SaveAs(FullName, 18); // 18 - xls 97-2003; 51 - xlsx 2007-2013

	
	//Excel.ActiveWorkBook.SaveAs(ИмяФайла);// первый вариант 
	//Попытка Книга.SaveAs ("D:\ProverkaZapisi\Результат.xls", ".xls");
	//Попытка Эксель.ActiveWorkbook.SaveCopyAs("D:\ProverkaZapisi\Результат.xls");
	//	Исключение
	//	Сообщить (ОписаниеОшибки()+"Файл не сохранён!");	
	//	КонецПопытки;
	//Эксель.Application.Quit();

	
	
	
	

	//Сообщить("Файл успешно сохранен");
	
			 


