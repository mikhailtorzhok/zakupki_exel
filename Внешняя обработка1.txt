
&НаКлиенте
Процедура Рассчитать(Команда)
	Сообщить("Привет, мир");
	МассивКорреспондентов = Новый Массив;
	МассивКорреспондентов = ЗапроситьСписокКонтрагентовНаСервере();
	//тзВСтроке = ЗапроситьСписокКонтрагентовНаСервере();
	Сообщить("Возврат Корреспондентов");
	//тз = ЗначениеИзСтрокиВнутр(тзВСтроке);
	//Сообщить(СтрДлина(тзВСтроке));
	//Сообщить ("Успешное восстановление таблицы из строки");	
	//Сообщить(МассивКорреспондентов[0]);
	i=0;
	Для Каждого Корреспондент Из МассивКорреспондентов Цикл
        Сообщить(Корреспондент);
		//НапечататьТаблицуКорреспондентов(Корреспондент);
		//Сообщить("Корреспондент.ИНН" + Корреспондент.ИНН);
		Сообщить("Корреспондент.Ссылка" + " = " + Корреспондент.Ссылка);
		i=i+1;
		Если i>=2 Тогда
            Прервать;
        КонецЕсли;
    КонецЦикла;

	
КонецПроцедуры



 &НаСервере
Функция ЗапроситьСписокКонтрагентовНаСервере()
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	Корреспонденты.Ссылка КАК Ссылка,
		|	Корреспонденты.ИНН КАК ИНН
		|ИЗ
		|	Справочник.Корреспонденты КАК Корреспонденты";
	РезультатЗапроса = Запрос.Выполнить();
	ТабКорреспондентов = РезультатЗапроса.Выгрузить();	
	//тзВСтроке = ЗначениеВСтрокуВнутр(ТабКорреспондентов); 	
	Сообщить("Создание таблицы корреспонденты завершено");	
	//Возврат(тзВСтроке);
	
	МассивКорреспондентов = Новый Массив;
	МассивКорреспондентов = ТаблицаЗначенийВМассив1(ТабКорреспондентов);
	Возврат(МассивКорреспондентов);
	
	
	
КонецФункции

&НаСервере
Функция ТаблицаЗначенийВМассив1(ТаблицаЗначений) 
    
    Массив = Новый Массив();
    СтруктураСтрокой = "";
    НужнаЗапятая = Ложь;
    Для Каждого Колонка Из ТаблицаЗначений.Колонки Цикл
        Если НужнаЗапятая Тогда
            СтруктураСтрокой = СтруктураСтрокой + ",";
        КонецЕсли;
        СтруктураСтрокой = СтруктураСтрокой + Колонка.Имя;
        НужнаЗапятая = Истина;
    КонецЦикла;
    Для Каждого Строка Из ТаблицаЗначений Цикл
        НоваяСтрока = Новый Структура(СтруктураСтрокой);
        ЗаполнитьЗначенияСвойств(НоваяСтрока, Строка);
        Массив.Добавить(НоваяСтрока);
    КонецЦикла;
    Возврат Массив;

КонецФункции

&НаСервере
Процедура НапечататьТаблицуКорреспондентов(Структура)

	ТабДок = Новый ТабличныйДокумент;	
	Макет = Справочники.Корреспонденты.ПолучитьМакет("ПечатьСтруктуры");
	ОбластьЗаголовок = Макет.ПолучитьОбласть("Заголовок");
	ОбластьПодвал = Макет.ПолучитьОбласть("Подвал");
	ОбластьДетальныхЗаписей = Макет.ПолучитьОбласть("Детали");
	
	ТабДок.Очистить();
	ТабДок.Вывести(ОбластьЗаголовок);
	//Перебор СТРУКТУРЫ и вывод в Табличный документ. РК - Структура с данными
	Для Каждого Элемент из Структура Цикл           
		//Сообщить(Элемент.Ключ + ": " + Элемент.Значение);
		Если ТипЗнч(Элемент.Значение) = Тип("Структура") Тогда
			Для Каждого ЭлементВ из Элемент.Значение Цикл
				ОбластьДетальныхЗаписей.Параметры.Заполнить(ЭлементВ); 
				ТабДок.Вывести(ОбластьДетальныхЗаписей);
			КонецЦикла;	
		Иначе
			ОбластьДетальныхЗаписей.Параметры.Заполнить(Элемент); 
			ТабДок.Вывести(ОбластьДетальныхЗаписей);
		КонецЕсли;	
	КонецЦикла; 	
	ТабДок.Вывести(ОбластьПодвал);
	ТабДок.Показать();
	//УниверсальныеМеханизмы.НапечататьДокумент(ТабДок); // или ТабДок.Показать(); 
КонецПроцедуры

	
			 


